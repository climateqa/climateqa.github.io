"use strict";(self.webpackChunkclimateqa=self.webpackChunkclimateqa||[]).push([[8767],{4989:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>d,toc:()=>c});var r=i(4848),t=i(8453);const s={sidebar_position:2},a="Talk to IPCC - Technical Documentation",d={id:"tutorial-extras/talk-to-ipcc-technical",title:"Talk to IPCC - Technical Documentation",description:"This page provides comprehensive technical documentation for the Talk to IPCC feature, including data processing pipelines, storage optimization strategies, and query mechanisms.",source:"@site/docs/tutorial-extras/talk-to-ipcc-technical.md",sourceDirName:"tutorial-extras",slug:"/tutorial-extras/talk-to-ipcc-technical",permalink:"/docs/tutorial-extras/talk-to-ipcc-technical",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Developer Documentation",permalink:"/docs/tutorial-extras/devs-intro"},next:{title:"Changelog",permalink:"/docs/category/changelog"}},l={},c=[{value:"Overview",id:"overview",level:2},{value:"Data Sources and Structure",id:"data-sources-and-structure",level:2},{value:"Source Dataset",id:"source-dataset",level:3},{value:"Climate Indicators Available",id:"climate-indicators-available",level:3},{value:"Heat and Cold Indicators",id:"heat-and-cold-indicators",level:4},{value:"Precipitation and Drought Indicators",id:"precipitation-and-drought-indicators",level:4},{value:"Environmental Conditions",id:"environmental-conditions",level:4},{value:"Data Processing Pipeline",id:"data-processing-pipeline",level:2},{value:"1. Data Transformation Architecture",id:"1-data-transformation-architecture",level:3},{value:"2. Coordinate System Integration",id:"2-coordinate-system-integration",level:3},{value:"3. Performance-Optimized Storage Strategy",id:"3-performance-optimized-storage-strategy",level:3},{value:"Tier 1: Regular Countries",id:"tier-1-regular-countries",level:4},{value:"Tier 2: Macro Countries (19 countries)",id:"tier-2-macro-countries-19-countries",level:4},{value:"Tier 3: Huge Macro Countries (5 countries)",id:"tier-3-huge-macro-countries-5-countries",level:4},{value:"4. Data Schema",id:"4-data-schema",level:3},{value:"Query Processing System",id:"query-processing-system",level:2},{value:"1. Visualization Types and Queries",id:"1-visualization-types-and-queries",level:3},{value:"Evolution Plot",id:"evolution-plot",level:4},{value:"Choropleth Map",id:"choropleth-map",level:4},{value:"2. Query Optimization Strategy",id:"2-query-optimization-strategy",level:3},{value:"Intelligent Routing",id:"intelligent-routing",level:4},{value:"Statistical Aggregation Methods",id:"statistical-aggregation-methods",level:4},{value:"Technical Implementation",id:"technical-implementation",level:2},{value:"1. Backend Architecture",id:"1-backend-architecture",level:3},{value:"2. Performance Optimizations",id:"2-performance-optimizations",level:3},{value:"3. Error Handling and Validation",id:"3-error-handling-and-validation",level:3},{value:"API Reference",id:"api-reference",level:2},{value:"Main Functions",id:"main-functions",level:3},{value:"<code>ask_ipcc(query: str, index_state: int = 0, user_id: str | None = None)</code>",id:"ask_ipccquery-str-index_state-int--0-user_id-str--none--none",level:4},{value:"<code>ipcc_workflow(user_input: str)</code>",id:"ipcc_workflowuser_input-str",level:4},{value:"Configuration Constants",id:"configuration-constants",level:3}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"talk-to-ipcc---technical-documentation",children:"Talk to IPCC - Technical Documentation"}),"\n",(0,r.jsx)(n.p,{children:"This page provides comprehensive technical documentation for the Talk to IPCC feature, including data processing pipelines, storage optimization strategies, and query mechanisms."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Talk to IPCC provides interactive access to the IPCC-WGI AR6 Interactive Atlas Dataset (CMIP6), enabling users to query global climate projections through natural language interfaces. The system transforms raw NetCDF climate data into an optimized, queryable format supporting real-time visualization generation."}),"\n",(0,r.jsx)(n.h2,{id:"data-sources-and-structure",children:"Data Sources and Structure"}),"\n",(0,r.jsx)(n.h3,{id:"source-dataset",children:"Source Dataset"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Origin"}),": IPCC-WGI AR6 Interactive Atlas Dataset hosted on DIGITAL.CSIC"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Format"}),": NetCDF files with 1\xb0\xd71\xb0 spatial resolution"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Coverage"}),": 180 \xd7 360 grid points globally (64,800 total grid points)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Coordinates"}),": Longitudes from -179.5\xb0 to 179.5\xb0, latitudes from -89.5\xb0 to 89.5\xb0"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Temporal Range"}),":","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Historical: 1850-2015"}),"\n",(0,r.jsx)(n.li,{children:"Projections: 2016-2100"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenarios"}),": Historical + 4 SSP scenarios (SSP1-2.6, SSP2-4.5, SSP3-7.0, SSP5-8.5)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Realizations"}),": Multiple climate model outputs per scenario for ensemble analysis"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"climate-indicators-available",children:"Climate Indicators Available"}),"\n",(0,r.jsx)(n.p,{children:"The dataset includes 22 comprehensive climate indicators across multiple categories:"}),"\n",(0,r.jsx)(n.h4,{id:"heat-and-cold-indicators",children:"Heat and Cold Indicators"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Code"}),(0,r.jsx)(n.th,{children:"Name"}),(0,r.jsx)(n.th,{children:"Unit"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"t"})}),(0,r.jsx)(n.td,{children:"Monthly mean temperature"}),(0,r.jsx)(n.td,{children:"\xb0C"}),(0,r.jsx)(n.td,{children:"Monthly mean of daily mean temperature"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tn"})}),(0,r.jsx)(n.td,{children:"Monthly minimum temperature"}),(0,r.jsx)(n.td,{children:"\xb0C"}),(0,r.jsx)(n.td,{children:"Monthly mean of daily minimum temperature"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tx"})}),(0,r.jsx)(n.td,{children:"Monthly maximum temperature"}),(0,r.jsx)(n.td,{children:"\xb0C"}),(0,r.jsx)(n.td,{children:"Monthly mean of daily maximum temperature"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tnn"})}),(0,r.jsx)(n.td,{children:"Temperature minimum extreme"}),(0,r.jsx)(n.td,{children:"\xb0C"}),(0,r.jsx)(n.td,{children:"Monthly minimum of daily minimum temperature"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"txx"})}),(0,r.jsx)(n.td,{children:"Temperature maximum extreme"}),(0,r.jsx)(n.td,{children:"\xb0C"}),(0,r.jsx)(n.td,{children:"Monthly maximum of daily maximum temperature"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tx35"})}),(0,r.jsx)(n.td,{children:"Hot days"}),(0,r.jsx)(n.td,{children:"days"}),(0,r.jsx)(n.td,{children:"Monthly count of days with maximum temperature above 35\xb0C"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tx40"})}),(0,r.jsx)(n.td,{children:"Very hot days"}),(0,r.jsx)(n.td,{children:"days"}),(0,r.jsx)(n.td,{children:"Monthly count of days with maximum temperature above 40\xb0C"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tx35ba"})}),(0,r.jsx)(n.td,{children:"Hot days (bias-adjusted)"}),(0,r.jsx)(n.td,{children:"days"}),(0,r.jsx)(n.td,{children:"Monthly bias adjusted TX35"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"tx40ba"})}),(0,r.jsx)(n.td,{children:"Very hot days (bias-adjusted)"}),(0,r.jsx)(n.td,{children:"days"}),(0,r.jsx)(n.td,{children:"Monthly bias adjusted TX40"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cd"})}),(0,r.jsx)(n.td,{children:"Cooling degree days"}),(0,r.jsx)(n.td,{children:"days"}),(0,r.jsx)(n.td,{children:"Annual cooling degree days"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"hd"})}),(0,r.jsx)(n.td,{children:"Heating degree days"}),(0,r.jsx)(n.td,{children:"\xb0C days"}),(0,r.jsx)(n.td,{children:"Annual heating degree days"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"fd"})}),(0,r.jsx)(n.td,{children:"Frost days"}),(0,r.jsx)(n.td,{children:"days"}),(0,r.jsx)(n.td,{children:"Monthly frost days"})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"precipitation-and-drought-indicators",children:"Precipitation and Drought Indicators"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Code"}),(0,r.jsx)(n.th,{children:"Name"}),(0,r.jsx)(n.th,{children:"Unit"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pr"})}),(0,r.jsx)(n.td,{children:"Total precipitation"}),(0,r.jsx)(n.td,{children:"mm/day"}),(0,r.jsx)(n.td,{children:"Monthly mean of daily total precipitation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"rx1day"})}),(0,r.jsx)(n.td,{children:"Maximum 1-day precipitation"}),(0,r.jsx)(n.td,{children:"mm"}),(0,r.jsx)(n.td,{children:"Monthly maximum of 1-day accumulated precipitation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"rx5day"})}),(0,r.jsx)(n.td,{children:"Maximum 5-day precipitation"}),(0,r.jsx)(n.td,{children:"mm"}),(0,r.jsx)(n.td,{children:"Monthly maximum of 5-day accumulated precipitation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"cdd"})}),(0,r.jsx)(n.td,{children:"Consecutive dry days"}),(0,r.jsx)(n.td,{children:"days"}),(0,r.jsx)(n.td,{children:"Annual consecutive dry days"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"spi6"})}),(0,r.jsx)(n.td,{children:"Standardized Precipitation Index"}),(0,r.jsx)(n.td,{children:"1"}),(0,r.jsx)(n.td,{children:"SPI for 6 months cumulation period"})]})]})]}),"\n",(0,r.jsx)(n.h4,{id:"environmental-conditions",children:"Environmental Conditions"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Code"}),(0,r.jsx)(n.th,{children:"Name"}),(0,r.jsx)(n.th,{children:"Unit"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"sfcwind"})}),(0,r.jsx)(n.td,{children:"Wind speed"}),(0,r.jsx)(n.td,{children:"m/s"}),(0,r.jsx)(n.td,{children:"Monthly mean of daily mean wind speed"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"prsn"})}),(0,r.jsx)(n.td,{children:"Snowfall"}),(0,r.jsx)(n.td,{children:"mm/day"}),(0,r.jsx)(n.td,{children:"Monthly mean of accumulated snowfall precipitation"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"siconc"})}),(0,r.jsx)(n.td,{children:"Sea ice concentration"}),(0,r.jsx)(n.td,{children:"%"}),(0,r.jsx)(n.td,{children:"Monthly mean of sea-ice area percentage"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"sst"})}),(0,r.jsx)(n.td,{children:"Sea surface temperature"}),(0,r.jsx)(n.td,{children:"\xb0C"}),(0,r.jsx)(n.td,{children:"Monthly mean of sea surface temperature"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ph"})}),(0,r.jsx)(n.td,{children:"Ocean pH"}),(0,r.jsx)(n.td,{children:"pH"}),(0,r.jsx)(n.td,{children:"Monthly mean of pH at surface"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note"}),": Currently, Talk to IPCC supports only ",(0,r.jsx)(n.code,{children:"t"})," (mean temperature) and ",(0,r.jsx)(n.code,{children:"pr"})," (total precipitation). Additional indicators will be integrated in future releases."]}),"\n",(0,r.jsx)(n.h2,{id:"data-processing-pipeline",children:"Data Processing Pipeline"}),"\n",(0,r.jsx)(n.h3,{id:"1-data-transformation-architecture",children:"1. Data Transformation Architecture"}),"\n",(0,r.jsx)(n.p,{children:"The system implements a sophisticated pipeline to transform raw NetCDF files into optimized Parquet format:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-mermaid",children:"graph TD\n    A[NetCDF Files<br/>DIGITAL.CSIC] --\x3e B[Coordinate Processing]\n    B --\x3e C[Country Classification]\n    C --\x3e D{Country Size}\n    D --\x3e|Small/Medium| E[Regular Processing]\n    D --\x3e|Large Grid| F[Macro Processing]\n    D --\x3e|Huge Grid| G[Double Aggregation]\n    E --\x3e H[Country.parquet]\n    F --\x3e I[Country_macro.parquet]\n    G --\x3e J[Country_macro.parquet<br/>Double Aggregated]\n    H --\x3e K[Query Engine]\n    I --\x3e K\n    J --\x3e K\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-coordinate-system-integration",children:"2. Coordinate System Integration"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Coordinates Table Creation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Global 1\xb0\xd71\xb0 grid extraction from NetCDF files"}),"\n",(0,r.jsxs)(n.li,{children:["Reverse geocoding using ",(0,r.jsx)(n.code,{children:"reverse_geocoder.search()"})," for location mapping"]}),"\n",(0,r.jsxs)(n.li,{children:["ISO alpha-2 country codes via ",(0,r.jsx)(n.code,{children:"pycountry"})," library"]}),"\n",(0,r.jsx)(n.li,{children:"Administrative region (admin1) identification"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Schema:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE coordinates (\n    latitude FLOAT64,\n    longitude FLOAT64,\n    country_code STRING,  -- ISO alpha-2\n    admin1 STRING,        -- Region/state/province\n    country_name STRING\n);\n"})}),"\n",(0,r.jsx)(n.h3,{id:"3-performance-optimized-storage-strategy",children:"3. Performance-Optimized Storage Strategy"}),"\n",(0,r.jsx)(n.p,{children:"The system uses a three-tier optimization approach based on country grid size:"}),"\n",(0,r.jsx)(n.h4,{id:"tier-1-regular-countries",children:"Tier 1: Regular Countries"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Storage"}),": Single Parquet file per country per indicator"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"File naming"}),": ",(0,r.jsx)(n.code,{children:"{indicator}/{country_code}.parquet"})," (e.g., ",(0,r.jsx)(n.code,{children:"mean_temperature/FR.parquet"}),")"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Processing"}),": Real-time aggregation during query execution"]}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"tier-2-macro-countries-19-countries",children:"Tier 2: Macro Countries (19 countries)"}),"\n",(0,r.jsx)(n.p,{children:"Countries with large grid coverage requiring pre-aggregation for performance:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Country Code"}),(0,r.jsx)(n.th,{children:"Country Name"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"JP"}),(0,r.jsx)(n.td,{children:"Japan"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"IN"}),(0,r.jsx)(n.td,{children:"India"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"MH"}),(0,r.jsx)(n.td,{children:"Marshall Islands"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PT"}),(0,r.jsx)(n.td,{children:"Portugal"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ID"}),(0,r.jsx)(n.td,{children:"Indonesia"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SJ"}),(0,r.jsx)(n.td,{children:"Svalbard and Jan Mayen"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"MX"}),(0,r.jsx)(n.td,{children:"Mexico"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CN"}),(0,r.jsx)(n.td,{children:"China"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"GL"}),(0,r.jsx)(n.td,{children:"Greenland"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PN"}),(0,r.jsx)(n.td,{children:"Pitcairn"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"AR"}),(0,r.jsx)(n.td,{children:"Argentina"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"AQ"}),(0,r.jsx)(n.td,{children:"Antarctica"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"PF"}),(0,r.jsx)(n.td,{children:"French Polynesia"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"BR"}),(0,r.jsx)(n.td,{children:"Brazil"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"SH"}),(0,r.jsx)(n.td,{children:"Saint Helena, Ascension and Tristan da Cunha"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"GS"}),(0,r.jsx)(n.td,{children:"South Georgia and the South Sandwich Islands"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"ZA"}),(0,r.jsx)(n.td,{children:"South Africa"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"NZ"}),(0,r.jsx)(n.td,{children:"New Zealand"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"TF"}),(0,r.jsx)(n.td,{children:"French Southern Territories"})]})]})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Storage"}),": Both raw and pre-aggregated files"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pre-aggregation SQL"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT latitude, longitude, scenario, year, month, \n       MEDIAN({indicator}) AS {indicator}, \n       country_code, country_name\nFROM 'hf://datasets/ekimetrics/ipcc-atlas/{indicator}/{country_code}.parquet'\nGROUP BY latitude, longitude, scenario, year, month, country_code, country_name\n"})}),"\n",(0,r.jsx)(n.h4,{id:"tier-3-huge-macro-countries-5-countries",children:"Tier 3: Huge Macro Countries (5 countries)"}),"\n",(0,r.jsx)(n.p,{children:"Countries requiring double aggregation for optimal performance:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Country Code"}),(0,r.jsx)(n.th,{children:"Country Name"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CL"}),(0,r.jsx)(n.td,{children:"Chile"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"CA"}),(0,r.jsx)(n.td,{children:"Canada"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"AU"}),(0,r.jsx)(n.td,{children:"Australia"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"US"}),(0,r.jsx)(n.td,{children:"United States"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"RU"}),(0,r.jsx)(n.td,{children:"Russia"})]})]})]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Double aggregation SQL"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"WITH medians_per_month AS (\n    SELECT latitude, longitude, year, scenario, month, \n           MEDIAN({indicator}) AS median_value\n    FROM 'hf://datasets/ekimetrics/ipcc-atlas/{indicator}/{country_code}.parquet'\n    GROUP BY latitude, longitude, scenario, year, month\n)\nSELECT latitude, longitude, year, scenario, \n       AVG(median_value) AS {indicator}\nFROM medians_per_month\nGROUP BY latitude, longitude, scenario, year\nORDER BY latitude, longitude, year, scenario\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-data-schema",children:"4. Data Schema"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Indicator Tables Schema:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"CREATE TABLE {indicator_table} (\n    latitude FLOAT32,\n    longitude FLOAT32,\n    year INT,\n    month INT,\n    realization STRING,      -- Climate model identifier\n    {indicator} FLOAT32,     -- Indicator value\n    projection STRING,       -- Always 'CMIP6'\n    scenario STRING,         -- 'historical' or SSP scenario\n    country_code STRING,\n    country_name STRING\n);\n"})}),"\n",(0,r.jsx)(n.h2,{id:"query-processing-system",children:"Query Processing System"}),"\n",(0,r.jsx)(n.h3,{id:"1-visualization-types-and-queries",children:"1. Visualization Types and Queries"}),"\n",(0,r.jsx)(n.h4,{id:"evolution-plot",children:"Evolution Plot"}),"\n",(0,r.jsx)(n.p,{children:"Shows temporal evolution of indicators at specific locations with historical data and future projections."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Regular Countries Query Example"})," (Paris, France):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"WITH medians_per_month AS (\n    SELECT year, scenario, month, MEDIAN(mean_temperature) AS median_value\n    FROM 'hf://datasets/ekimetrics/ipcc-atlas/mean_temperature/FR.parquet'\n    WHERE latitude = 48.5 AND longitude = 2.5 AND year >= 1950\n    GROUP BY scenario, year, month\n)\nSELECT year, scenario, AVG(median_value) AS mean_temperature\nFROM medians_per_month\nGROUP BY scenario, year\nORDER BY year, scenario\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Macro Countries Query Example"})," (Shanghai, China):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT year, scenario, AVG(mean_temperature) as mean_temperature\nFROM 'hf://datasets/ekimetrics/ipcc-atlas/mean_temperature/CN_macro.parquet'\nWHERE latitude = 31.5 AND longitude = 121.5 AND year >= 1950\nGROUP BY scenario, year\nORDER BY year, scenario\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Huge Macro Countries Query Example"})," (New York, USA):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"SELECT year, scenario, mean_temperature\nFROM 'hf://datasets/ekimetrics/ipcc-atlas/mean_temperature/US_macro.parquet'\nWHERE latitude = 40.5 AND longitude = -74.5 AND year >= 1950\nORDER BY year, scenario\n"})}),"\n",(0,r.jsx)(n.h4,{id:"choropleth-map",children:"Choropleth Map"}),"\n",(0,r.jsx)(n.p,{children:"Displays spatial distribution of indicators across countries for specific years."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Regular Countries Query Example"})," (France, 2050):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sql",children:"WITH medians_per_month AS (\n    SELECT latitude, longitude, scenario, month, \n           MEDIAN(mean_temperature) AS median_value\n    FROM 'hf://datasets/ekimetrics/ipcc-atlas/mean_temperature/FR.parquet'\n    WHERE year = 2050\n    GROUP BY latitude, longitude, scenario, month\n)\nSELECT latitude, longitude, scenario, AVG(median_value) AS mean_temperature\nFROM medians_per_month\nGROUP BY latitude, longitude, scenario\nORDER BY latitude, longitude, scenario\n"})}),"\n",(0,r.jsx)(n.h3,{id:"2-query-optimization-strategy",children:"2. Query Optimization Strategy"}),"\n",(0,r.jsx)(n.h4,{id:"intelligent-routing",children:"Intelligent Routing"}),"\n",(0,r.jsx)(n.p,{children:"The system automatically selects the appropriate query strategy based on:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Country classification (Regular/Macro/Huge Macro)"}),"\n",(0,r.jsx)(n.li,{children:"Available pre-aggregated data"}),"\n",(0,r.jsx)(n.li,{children:"Query complexity and expected performance"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"statistical-aggregation-methods",children:"Statistical Aggregation Methods"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ensemble Handling"}),": Median computation across climate model realizations for statistical robustness"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Temporal Aggregation"}),": Monthly medians averaged to annual values for consistency"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Spatial Consistency"}),": Grid-point level precision maintained throughout processing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Scenario Preservation"}),": All SSP scenarios processed independently to maintain projection integrity"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"technical-implementation",children:"Technical Implementation"}),"\n",(0,r.jsx)(n.h3,{id:"1-backend-architecture",children:"1. Backend Architecture"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Core Components:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Workflow Engine"}),": ",(0,r.jsx)(n.code,{children:"ipcc_workflow()"})," orchestrates query processing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parameter Extraction"}),": LLM-powered analysis of natural language queries"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"SQL Generation"}),": Dynamic query building based on country tier and visualization type"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Parallel Processing"}),": Asynchronous execution of multiple visualizations"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Files:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"climateqa/engine/talk_to_data/workflow/ipcc.py"})," - Main workflow orchestration"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"climateqa/engine/talk_to_data/ipcc/queries.py"})," - SQL query generation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"climateqa/engine/talk_to_data/ipcc/plots.py"})," - Visualization functions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"climateqa/engine/talk_to_data/ipcc/config.py"})," - Configuration and constants"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-performance-optimizations",children:"2. Performance Optimizations"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Storage Optimizations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Zstandard (zstd) compression for Parquet files"}),"\n",(0,r.jsx)(n.li,{children:"Country-based partitioning for efficient filtering"}),"\n",(0,r.jsx)(n.li,{children:"Pre-computed aggregations for large countries"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Query Optimizations:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Adaptive SQL generation based on data availability"}),"\n",(0,r.jsx)(n.li,{children:"Parallel execution of multiple visualization queries"}),"\n",(0,r.jsx)(n.li,{children:"Efficient memory management for large datasets"}),"\n",(0,r.jsx)(n.li,{children:"Connection pooling for database access"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Caching Strategy:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Query result caching for repeated requests"}),"\n",(0,r.jsx)(n.li,{children:"Intermediate result storage for complex aggregations"}),"\n",(0,r.jsx)(n.li,{children:"Metadata caching for faster parameter extraction"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-error-handling-and-validation",children:"3. Error Handling and Validation"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Data Validation:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Coordinate bounds checking (-90 to 90 latitude, -180 to 180 longitude)"}),"\n",(0,r.jsx)(n.li,{children:"Year range validation (1850-2100)"}),"\n",(0,r.jsx)(n.li,{children:"Country code verification against available datasets"}),"\n",(0,r.jsx)(n.li,{children:"Scenario validation against supported SSP scenarios"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error Recovery:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Graceful degradation when data is unavailable"}),"\n",(0,r.jsx)(n.li,{children:"Alternative query strategies for performance issues"}),"\n",(0,r.jsx)(n.li,{children:"User-friendly error messages for invalid requests"}),"\n",(0,r.jsx)(n.li,{children:"Logging and monitoring for system health"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"api-reference",children:"API Reference"}),"\n",(0,r.jsx)(n.h3,{id:"main-functions",children:"Main Functions"}),"\n",(0,r.jsx)(n.h4,{id:"ask_ipccquery-str-index_state-int--0-user_id-str--none--none",children:(0,r.jsx)(n.code,{children:"ask_ipcc(query: str, index_state: int = 0, user_id: str | None = None)"})}),"\n",(0,r.jsx)(n.p,{children:"Main entry point for IPCC data queries."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"query"}),": Natural language question about climate data"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"index_state"}),": Index of result to return (for pagination)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"user_id"}),": User identifier for logging purposes"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"tuple[\n    str,           # SQL query used\n    pd.DataFrame,  # Resulting data\n    Callable,      # Figure generation function\n    str,           # Plot information\n    list,          # All SQL queries\n    list,          # All dataframes\n    list,          # All figure functions\n    list,          # All plot information\n    int,           # Current index\n    list,          # Table names\n    str            # Error message (if any)\n]\n"})}),"\n",(0,r.jsx)(n.h4,{id:"ipcc_workflowuser_input-str",children:(0,r.jsx)(n.code,{children:"ipcc_workflow(user_input: str)"})}),"\n",(0,r.jsx)(n.p,{children:"Core workflow processing function."}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Parameters:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"user_input"}),": User's natural language query"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Returns:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"State = {\n    'user_input': str,\n    'plots': list,\n    'outputs': dict,\n    'error': str\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"configuration-constants",children:"Configuration Constants"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Available Scenarios:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'IPCC_SCENARIO = [\n    "historical",\n    "ssp126", \n    "ssp245",\n    "ssp370", \n    "ssp585"\n]\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Supported Indicators:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'IPCC_TABLES = [\n    "mean_temperature",\n    "total_precipitation"\n]\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Plot Parameters:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"IPCC_PLOT_PARAMETERS = [\n    'year',\n    'location'\n]\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>d});var r=i(6540);const t={},s=r.createContext(t);function a(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);